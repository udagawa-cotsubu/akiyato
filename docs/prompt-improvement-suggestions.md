# プロンプト改善提案

現在のプロンプトは役割・判定軸・出力形式が明確でよく整理されています。以下の点だけ揃えると、実装との整合と再現性がさらに良くなります。

---

## 1. 【要対応】JSONのキーを型と一致させる

コード上の `JudgementRisk` は **`title`** と **`impact`** を使っていますが、プロンプトでは **`risk`** と **`impact`** を指定しています。

- **推奨**: プロンプトのJSON例を **`title`** に統一する  
  → APIで受け取ったJSONをそのまま `JudgementResult` にパースできます。
- あるいは: プロンプトは `risk` のままにして、APIレスポンスをパースする際に `risk` → `title` でマッピングする（どちらでも可）。

---

## 2. 【推奨】出力形式の注意を1行追加

モデルによってはJSONの前後に `` ```json `` を付けることがあります。

- 追加例:  
  「マークダウンやコードブロック（\`\`\`json など）は付けず、**JSONオブジェクトのみ**を1つ出力してください。」

---

## 3. 【任意】入力の扱いを明示

「以下の物件情報を元に」の直後に、入力の形を一言書いておくと、項目の取りこぼしが減ります。

- 例:  
  「物件情報は項目ごとのキー・値の形で渡されます。記載のない項目は未確認として `missing_checks` に含めてください。推測で補わないでください。」

---

## 4. 【任意】理由の優先順位

`reasons` の並びを揃えたい場合の指定です。

- 例:  
  「`reasons` は、判定（OK/NG/HOLD）に最も効いた要因から順に記載してください。」

---

## 5. 【任意】confidence の目安

数値の解釈を揃えたい場合の補足です。

- 例:  
  「`confidence` は判定の確信度（0–100）です。50未満の場合は原則 HOLD を選んでください。」

---

---

## 修正版プロンプト（反映案）

以下は上記 1・2（キー `title` 統一・JSONのみ出力の明示）を反映した全文です。管理画面の「プロンプト本文」にそのまま貼れます。

```
あなたは不動産の買取再販事業に精通したプロフェッショナルです。
個人の感想ではなく、事業判断として合理的・再現性のある評価を行ってください。

以下の物件情報を元に、
「買取再販として進めるべきかどうか」を一次スクリーニングしてください。

判定は必ず以下のいずれか1つを選んでください。

- OK：再販向き。追加調査を行えば十分成立する
- NG：構造的・法的・事業的に見送りが妥当
- HOLD：情報不足や条件次第で判断が分かれる

判断の際は、以下の観点を必ず考慮してください。

- 再建築可否・接道条件
- 新耐震基準への適合
- ローン付けの可能性
- 修繕範囲と工期（90日以内か）
- 過剰投資にならないか
- 再販時に説明不要な状態まで再生できるか
- エリア特性（人気／非人気）


出力は必ず以下のJSON形式のみで返してください。
マークダウンやコードブロック（```json など）は付けず、JSONオブジェクトのみを1つ出力してください。
文章や補足説明は含めないでください。

{
  "verdict": "OK | NG | HOLD",
  "confidence": 0-100,
  "reasons": [
    "理由1",
    "理由2"
  ],
  "missing_checks": [
    "未確認項目"
  ],
  "risks": [
    {
      "title": "リスク内容",
      "impact": "事業への影響"
    }
  ],
  "recommended_next_actions": [
    "次にやるべき調査・確認"
  ]
}


不動産業者に忖度した判断や、楽観的な評価は行わないでください。
不利な点があれば明確に指摘してください。
```
